# Railway - Backend + PostgreSQL deploy ayarları
# https://docs.railway.app/reference/config-as-code

[build]
# Bağımlılıkları yükle (devDependencies dahil - migration için drizzle-kit gerekli)
# --no-frozen-lockfile: CI'da lockfile package.json ile senkron değilse build yine de geçer (lockfile güncellenir)
buildCommand = "pnpm install --no-frozen-lockfile && pnpm run build"

[deploy]
# Migration'ı birkaç kez dene (Postgres geç ayağa kalkabiliyor), sonra sunucuyu başlat
startCommand = "node scripts/railway-start.mjs"
